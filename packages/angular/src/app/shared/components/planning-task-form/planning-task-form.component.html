<dx-toolbar>
  <dxi-item location="before">
      <div class="panels-header">Details</div>
  </dxi-item>
  <dxi-item location="after" [visible]='!edit' locateInMenu="after" widget="dxButton"
      [options]="{text: 'Edit', icon: 'edit', stylingMode: 'outlined', type: 'default', onClick: toggleEdit}">
  </dxi-item>
  <dxi-item location="after" [visible]='edit' locateInMenu="after" widget="dxButton"
      [options]="{text: 'Save', stylingMode: 'outlined', type: 'default', onClick: toggleEdit}">
  </dxi-item>
  <dxi-item location="after" [visible]='edit' locateInMenu="after" widget="dxButton"
      [options]="{text: 'Cancel', onClick: toggleEdit}">
  </dxi-item>
</dx-toolbar>

<div *ngIf="edit then editingForm else form"></div>
<ng-template #form>
  <div class="info">
    <div>
        <div class="title">Company</div>
        <div class="value">{{ task.name }}</div>
    </div>
    <div>
        <div class="title">Assigned to</div>
        <div class="value">{{ task.owner }}</div>
    </div>
  </div>
  <div class="info">
    <div>
        <div class="title">Priority</div>
        <div class="value">
          <task-priority [value]="task.priority"></task-priority>
        </div>
    </div>
    <div>
        <div class="title">Status</div>
        <div class="value">
          <task-status [value]="task.status"></task-status>
        </div>
    </div>
  </div>
  <div class="info">
    <div>
        <div class="title">Start Date</div>
        <ng-template [ngIf]="!isEmptyStartDate">
          <div class="value black">{{ parseDate(task.startDate) }}</div>
        </ng-template>
        <dx-drop-down-button
            #dropDownButtonStartDate
            icon="event"
            text="START DATE"
            stylingMode="outlined"
            dropDownContentTemplate="dropDownContentTemplate"
            [dropDownOptions]="{ width: 'auto' }"
            [showArrowIcon]="false"
            [selectionMode]="false"
            [visible]="isEmptyStartDate"
        >
          <div *dxTemplate="let data of 'dropDownContentTemplate'">
            <dx-calendar
              name="Start Date"
              (onValueChanged)="changeDate($event)"
            ></dx-calendar>
          </div>
        </dx-drop-down-button>
    </div>
    <div>
        <div class="title">Due Date</div>
        <ng-template [ngIf]="!isEmptyDueDate">
          <div class="value black">{{ parseDate(task.dueDate) }}</div>
        </ng-template>
        <dx-drop-down-button
          #dropDownButtonDueDate
          icon="event"
          text="DUE DATE"
          stylingMode="outlined"
          dropDownContentTemplate="dropDownContentTemplate"
          [dropDownOptions]="{ width: 'auto' }"
          [showArrowIcon]="false"
          [visible]="isEmptyDueDate"
        >
          <div *dxTemplate="let data of 'dropDownContentTemplate'">
            <dx-calendar
              name="Due Date"
              (onValueChanged)="changeDate($event)"
            ></dx-calendar>
          </div>
        </dx-drop-down-button>
    </div>
  </div>
  <div class="info last long">
    <div>
        <div class="title">Details</div>
        <div class="value black">{{ task.description }}</div>
    </div>
  </div>
</ng-template>
<ng-template #editingForm>
  <dx-form
    [colCount]="2"
    [formData]="task"
    labelMode="floating"
  >
    <dxi-item
      [colSpan]="2"
      dataField="name"
    ></dxi-item>
    <dxi-item
      dataField="company"
    ></dxi-item>
    <dxi-item
      dataField="owner"
    >
      <dxo-label
        text="Assigned to"
      ></dxo-label>
    </dxi-item>
    <dxi-item
      dataField="priority"
      editorType="dxSelectBox"
      [editorOptions]="{ items: priorityList }"
    ></dxi-item>
    <dxi-item
      dataField="status"
      editorType="dxSelectBox"
      [editorOptions]="{ items: statusList }"
    ></dxi-item>
    <dxi-item
      dataField="startDate"
      editorType="dxDateBox"
      [editorOptions]="{ onValueChanged: changeDate, name: 'Start Date' }"
    ></dxi-item>
    <dxi-item
      dataField="dueDate"
      editorType="dxDateBox"
      [editorOptions]="{ onValueChanged: changeDate, name: 'Due Date' }"
    ></dxi-item>
    <dxi-item
      [colSpan]="2"
      dataField="description"
      editorType="dxTextArea"
    >
      <dxo-label
        text="Details"
      ></dxo-label>
    </dxi-item>
  </dx-form>
</ng-template>